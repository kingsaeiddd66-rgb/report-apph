<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“Š Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
<style>
/* --- Reset Ùˆ Ø·Ø±Ø§Ø­ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ --- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
body{background:#121212;color:#fff;line-height:1.5;}
.container{max-width:700px;margin:20px auto;padding:15px;}
h1,h2{text-align:center;color:#00e676;margin-bottom:15px;}
/* ÙØ±Ù… Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´ */
.form{background:#1e1e1e;padding:20px;border-radius:15px;box-shadow:0 4px 15px rgba(0,0,0,0.5);margin-bottom:25px;}
.form input,.form select,.form textarea,.form button{
  width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none;font-size:15px;
}
.form input:focus,.form select:focus,.form textarea:focus{outline:none;border:2px solid #00e676;}
button{background:#00e676;color:#000;font-weight:bold;cursor:pointer;transition:0.3s;}
button:hover{background:#00c853;}
textarea{resize:none;height:90px;}
/* Ø¬Ø¯ÙˆÙ„ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ */
table{width:100%;border-collapse:collapse;margin-top:20px;background:#1e1e1e;border-radius:10px;overflow:hidden;}
th,td{padding:10px;text-align:center;border-bottom:1px solid #333;}
th{background:#00e676;color:#000;}
tr:hover{background:#292929;transition:0.2s;}
/* Ù†Ù…ÙˆØ¯Ø§Ø± */
canvas{margin-top:20px;border-radius:12px;background:#1e1e1e;padding:10px;box-shadow:0 4px 12px rgba(0,0,0,0.5);}
</style>
</head>
<body>
<div class="container">
<h1>ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</h1>
<div class="form">
<input id="name" type="text" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
<input id="date" type="date">
<input id="hours" type="number" placeholder="Ø³Ø§Ø¹Øª Ú©Ø§Ø±">
<select id="category">
<option value="">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</option>
<option value="Ú©Ø§Ø±">Ú©Ø§Ø±</option>
<option value="Ø¯Ø±Ø³">Ø¯Ø±Ø³</option>
<option value="ØªÙ…Ø±ÛŒÙ†">ØªÙ…Ø±ÛŒÙ†</option>
<option value="Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ø®ØµÛŒ">Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ø®ØµÛŒ</option>
</select>
<select id="status">
<option value="">ÙˆØ¶Ø¹ÛŒØª</option>
<option value="Ø´Ø±ÙˆØ¹ Ù†Ø´Ø¯Ù‡">Ø´Ø±ÙˆØ¹ Ù†Ø´Ø¯Ù‡</option>
<option value="Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…">Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</option>
<option value="Ú©Ø§Ù…Ù„ Ø´Ø¯">Ú©Ø§Ù…Ù„ Ø´Ø¯</option>
</select>
<textarea id="desc" placeholder="Ø´Ø±Ø­ Ú©Ø§Ø±"></textarea>
<button onclick="saveReport()">Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´</button>
</div>

<h2>ğŸ“„ Ø¬Ø¯ÙˆÙ„ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§</h2>
<table id="reportTable">
<thead><tr><th>Ù†Ø§Ù…</th><th>ØªØ§Ø±ÛŒØ®</th><th>Ø³Ø§Ø¹Øª</th><th>Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</th><th>ÙˆØ¶Ø¹ÛŒØª</th><th>Ø´Ø±Ø­</th></tr></thead>
<tbody></tbody>
</table>

<h2>ğŸ“Š Ù†Ù…ÙˆØ¯Ø§Ø± Ù¾ÛŒØ´Ø±ÙØª</h2>
<canvas id="chart" height="200"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<script>
// --- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Firebase ---
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_STORAGE_BUCKET",
  messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// --- Ø§Ù„Ù…Ø§Ù†â€ŒÙ‡Ø§ ---
const nameInput=document.getElementById("name");
const dateInput=document.getElementById("date");
const hoursInput=document.getElementById("hours");
const categoryInput=document.getElementById("category");
const statusInput=document.getElementById("status");
const descInput=document.getElementById("desc");
const reportTable=document.querySelector("#reportTable tbody");
const chartCanvas=document.getElementById("chart");

// --- Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ù‡ ØªÙ„Ú¯Ø±Ø§Ù… ---
function sendTelegram(name,date,hours,category,status,desc){
  const token = "8246533418:AAEggP5OLxzA3fGTf9qeMCm6nl_TNPHb1ms"; // ØªÙˆÚ©Ù† Ø±Ø¨Ø§Øª Ø®ÙˆØ¯Øª
  const chat_id = "7095936175";  // Chat ID Ø®ÙˆØ¯Øª
  const text = `ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø¯ÛŒØ¯\nÙ†Ø§Ù…: ${name}\nØªØ§Ø±ÛŒØ®: ${date}\nØ³Ø§Ø¹Øª: ${hours}\nØ¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ: ${category}\nÙˆØ¶Ø¹ÛŒØª: ${status}\nØ´Ø±Ø­: ${desc}`;
  fetch(`https://api.telegram.org/bot${token}/sendMessage?chat_id=${chat_id}&text=${encodeURIComponent(text)}`);
}

// --- Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´ ---
function saveReport(){
  const name=nameInput.value.trim();
  const date=dateInput.value;
  const hours=parseFloat(hoursInput.value);
  const category=categoryInput.value;
  const status=statusInput.value;
  const desc=descInput.value.trim();
  if(!name||!date||!hours||!category||!status||!desc){alert("Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ù¾Ø± Ø´ÙˆØ¯!");return;}
  
  db.collection("reports").add({name,date,hours,category,status,desc,created:firebase.firestore.FieldValue.serverTimestamp()})
  .then(()=>{
    loadReports();
    clearForm();
    sendTelegram(name,date,hours,category,status,desc);
  });
}

function clearForm(){
  nameInput.value=""; dateInput.value=""; hoursInput.value=""; categoryInput.value=""; statusInput.value=""; descInput.value="";
}

// --- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ ---
function loadReports(){
  reportTable.innerHTML="";
  db.collection("reports").orderBy("created","desc").get().then(snapshot=>{
    let chartData={labels:[], data:[]};
    snapshot.forEach(doc=>{
      const r=doc.data();
      reportTable.innerHTML+=`<tr>
<td>${r.name}</td><td>${r.date}</td><td>${r.hours}</td><td>${r.category}</td><td>${r.status}</td><td>${r.desc}</td>
</tr>`;
      chartData.labels.push(r.date); chartData.data.push(r.hours);
    });
    renderChart(chartData);
  });
}

// --- Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø± ---
function renderChart(chartData){
  new Chart(chartCanvas,{
    type:'bar',
    data:{labels:chartData.labels,datasets:[{label:"Ø³Ø§Ø¹Øª Ú©Ø§Ø±",data:chartData.data,backgroundColor:'#00e676'}]},
    options:{scales:{y:{beginAtZero:true}}}
  });
}

loadReports();
</script>
</body>
</html>